<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="robots" content="noindex,nofollow">
<title>Streaming Player</title>
<link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css"/>
<style>
body,html{margin:0;padding:0;width:100%;height:100%;background:#000;font-family:Arial, sans-serif;overflow:hidden;}
.container-wrapper{width:100%;height:100%;display:flex;flex-direction:column;}
.player-container{position:relative;width:100%;flex-grow:1;background:#000;}
#video-player,.plyr{width:100%!important;height:100%!important;}
.tombol-download{display:block;width:100%;padding:15px;background-color:#007bff;color:#fff;text-align:center;text-decoration:none;font-weight:bold;flex-shrink:0;}
.tombol-download:hover{background-color:#0056b3;}
#adblock-warning{display:none;position:absolute;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.9);color:white;text-align:center;padding-top:50px;font-size:18px;z-index:30;}
</style>
</head>
<body>
<script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>

<div class="container-wrapper">
<div class="player-container">
<video id="video-player" playsinline controls></video>
<div id="adblock-warning">Matikan AdBlock untuk menonton!</div>
</div>
<a href="#" id="download-button" class="tombol-download" target="_blank" rel="noopener noreferrer">DOWNLOAD VIDEO</a>
</div>

<script>
const urlParams = new URLSearchParams(window.location.search);
const videoSource = urlParams.get('s');
const downloadLink = urlParams.get('d');
const subSource = urlParams.get('sub');
const downloadButton = document.getElementById('download-button');

// Download opsional
if(downloadLink){
  downloadButton.href = downloadLink;
}else{
  downloadButton.style.display = 'none';
}

// Inisialisasi player tanpa terlalu agresif cek AdBlock
document.addEventListener('DOMContentLoaded', ()=>{
  initializePlayer();
});

function initializePlayer(){
  const video=document.getElementById('video-player');
  if(!videoSource){
    document.getElementById('adblock-warning').innerText='Error: Video tidak ditemukan';
    document.getElementById('adblock-warning').style.display='block';
    video.style.display='none';
    downloadButton.style.display='none';
    return;
  }

  video.innerHTML = `<source src="${videoSource}" type="video/mp4"/>`;

  if(subSource){
    let track=document.createElement('track');
    track.kind='subtitles';
    track.src=subSource;
    track.srclang='id';
    track.label='Bahasa Indonesia';
    track.default=true;
    video.appendChild(track);
  }

  new Plyr('#video-player', {
    settings: ['speed','captions'],
    speed: {selected:1,options:[0.5,1,2,3]},
    controls: ['play','rewind','mute','volume','progress','current-time','duration','captions','settings','fast-forward','fullscreen']
  });
}
</script>
</body>
</html>
